[Mesh]
  [gmg]
    type = GeneratedMeshGenerator
    dim = 3
    nx = 50
    ny = 50
    nz = 50
    xmax = 5
    ymax = 5
    zmax = 5
  []
[]

[Variables]
  [phi]
  []
[]

[AuxVariables]
  [velocity]
    family = LAGRANGE_VEC
  []
[]

[ICs]
  [phi_ic]
    type = FunctionIC
    function = ls_exact
    variable = phi
  []
  [vel_ic]
    type = VectorFunctionIC
    variable = velocity
    function = velocity_func
  []
[]

[Functions]
  [velocity_func]
    type = ParsedVectorFunction
    # expression_x = '4*y'
    # expression_y = '-4*x'
    expression_x = 'if(y<2.8 & y>2.2 & z<2.8 & z>2.2, 1, 0)'
    expression_y = '0'
    expression_z = '0'
  []
[]

[Kernels]
  [time]
    type = TimeDerivative
    variable = phi
  []

  [advection]
    type = LevelSetAdvection
    velocity = velocity
    variable = phi
  []

  [advection_supg]
    type = LevelSetAdvectionSUPG
    velocity = velocity
    variable = phi
  []
  [time_supg]
    type = LevelSetTimeDerivativeSUPG
    velocity = velocity
    variable = phi
  []
[]

[AuxVariables]
  [refractive_index]
    [InitialCondition]
      type = FunctionIC
      function = '1.0 + (x > 2.5) * 0.3'
    []
  []
  [deposition]
    order = CONSTANT
    family = MONOMIAL
  []
[]

[Functions/ls_exact]
  type = LevelSetOlssonPlane
  epsilon = 0.1
  point = '2.5 2.5 0'
  normal = '1 0 0'
  # type = LevelSetOlssonBubble
  # epsilon = 0.05
  # center = '2.5 2.5 0'
  # radius = 1.5
[]

[RayBCs]
  [kill]
    type = KillRayBC
    boundary = 'top right bottom left back front'
  []
  # [reflect]
  #   type = ReflectRayBC
  #   boundary = 'left'
  # []
[]

[RayKernels]
  [refraction]
    type = LaserReflectionRayKernel
    phase = phi
    refractive_index = refractive_index
  []
  [deposition]
    type = LaserDepositionRayKernel
    variable = deposition
    depends_on = refraction
    phase = phi
  []
[]

[UserObjects/study]
  type = RepeatableRayStudy
  names = 'ray_1
  ray_2
  ray_3
  ray_4
  ray_5
  ray_6
  ray_7
  ray_8
  ray_9
  ray_10
  ray_11
  ray_12
  ray_13
  ray_14
  ray_15
  ray_16
  ray_17
  ray_18
  ray_19
  ray_20
  ray_21
  ray_22
  ray_23
  ray_24
  ray_25
  ray_26
  ray_27
  ray_28
  ray_29
  ray_30
  ray_31
  ray_32
  ray_33
  ray_34
  ray_35
  ray_36
  ray_37
  ray_38
  ray_39
  ray_40
  ray_41
  ray_42
  ray_43
  ray_44
  ray_45
  ray_46
  ray_47
  ray_48
  ray_49
  ray_50
  ray_51
  ray_52
  ray_53
  ray_54
  ray_55
  ray_56
  ray_57
  ray_58
  ray_59
  ray_60
  ray_61
  ray_62
  ray_63
  ray_64
  ray_65
  ray_66
  ray_67
  ray_68
  ray_69
  ray_70
  ray_71
  ray_72
  ray_73
  ray_74
  ray_75
  ray_76
  ray_77
  ray_78
  ray_79
  ray_80
  ray_81
  ray_82
  ray_83
  ray_84
  ray_85
  ray_86
  ray_87
  ray_88
  ray_89
  ray_90
  ray_91
  ray_92
  ray_93
  ray_94
  ray_95
  ray_96
  ray_97
  ray_98
  ray_99
  ray_100
  ray_101
  ray_102
  ray_103
  ray_104
  ray_105
  ray_106
  ray_107
  ray_108
  ray_109
  ray_110
  ray_111
  ray_112
  ray_113
  ray_114
  ray_115
  ray_116
  ray_117
  ray_118
  ray_119
  ray_120
  ray_121
  ray_122
  ray_123
  ray_124
  ray_125
  ray_126
  ray_127
  ray_128
  ray_129
  ray_130
  ray_131
  ray_132
  ray_133
  ray_134
  ray_135
  ray_136
  ray_137
  ray_138
  ray_139
  ray_140
  ray_141
  ray_142
  ray_143
  ray_144
  ray_145
  ray_146
  ray_147
  ray_148
  ray_149
  ray_150
  ray_151
  ray_152
  ray_153
  ray_154
  ray_155
  ray_156
  ray_157
  ray_158
  ray_159
  ray_160
  ray_161
  ray_162
  ray_163
  ray_164
  ray_165
  ray_166
  ray_167
  ray_168
  ray_169
  ray_170
  ray_171
  ray_172
  ray_173
  ray_174
  ray_175
  ray_176
  ray_177
  ray_178
  ray_179
  ray_180
  ray_181
  ray_182
  ray_183
  ray_184
  ray_185
  ray_186
  ray_187
  ray_188
  ray_189
  ray_190
  ray_191
  ray_192
  ray_193
  ray_194
  ray_195
  ray_196
  ray_197
  ray_198
  ray_199
  ray_200
  ray_201
  ray_202
  ray_203
  ray_204
  ray_205
  ray_206
  ray_207
  ray_208
  ray_209
  ray_210
  ray_211
  ray_212
  ray_213
  ray_214
  ray_215
  ray_216
  ray_217
  ray_218
  ray_219
  ray_220
  ray_221
  ray_222
  ray_223
  ray_224
  ray_225
  ray_226
  ray_227
  ray_228
  ray_229
  ray_230
  ray_231
  ray_232
  ray_233
  ray_234
  ray_235
  ray_236
  ray_237
  ray_238
  ray_239
  ray_240
  ray_241
  ray_242
  ray_243
  ray_244
  ray_245
  ray_246
  ray_247
  ray_248
  ray_249
  ray_250
  ray_251
  ray_252
  ray_253
  ray_254
  ray_255
  ray_256
  ray_257
  ray_258
  ray_259
  ray_260
  ray_261
  ray_262
  ray_263
  ray_264
  ray_265
  ray_266
  ray_267
  ray_268
  ray_269
  ray_270
  ray_271
  ray_272
  ray_273
  ray_274
  ray_275
  ray_276
  ray_277
  ray_278
  ray_279
  ray_280
  ray_281
  ray_282
  ray_283
  ray_284
  ray_285
  ray_286
  ray_287
  ray_288
  ray_289
  ray_290
  ray_291
  ray_292
  ray_293
  ray_294
  ray_295
  ray_296
  ray_297
  ray_298
  ray_299'
  start_points = '0 2.501594044074067 2.4818366899492252
  0 2.514321958253864 2.5186804583979883
  0 2.4725741963670536 2.4951487615039856
  0 2.5266463803413615 2.483049753977142
  0 2.490936233908707 2.5337167580803373
  0 2.482506147512799 2.4663166515614097
  0 2.5382966032005734 2.513985858066312
  0 2.459880152363486 2.5165608898870153
  0 2.519448465507565 2.458439758863768
  0 2.5144375468662243 2.5460291744446937
  0 2.4563196095029594 2.4746863208664904
  0 2.551406836188756 2.4886983512714123
  0 2.4685407815156286 2.5447475010357934
  0 2.492714846441876 2.4437809727947553
  0 2.544817066450584 2.5377718710511834
  0 2.4395792093341373 2.502498589387835
  0 2.5441444601402843 2.456070366058734
  0 2.4970422403771213 2.5639642788044843
  0 2.457879483990301 2.4495255446615323
  0 2.5668030756055247 2.508988259339529
  0 2.4433365650665144 2.5394249421499193
  0 2.5154990248459335 2.4311052806342555
  0 2.5358809389996435 2.56261702284393
  0 2.429797695406041 2.477603550087032
  0 2.5682451010868586 2.468469032328117
  0 2.4704134439426015 2.5706955631635893
  0 2.473577175217406 2.4265378159422366
  0 2.57035162082306 2.5369748402196755
  0 2.421812115047833 2.520610075547717
  0 2.5444664401169184 2.4308444689386444
  0 2.5141521703006937 2.582347428948957
  0 2.432899358008172 2.448033491278693
  0 2.585872181940615 2.492885665257468
  0 2.4406192711276913 2.5641888279557903
  0 2.5004327091736216 2.411299827710486
  0 2.56043060470884 2.5666159216825535
  0 2.409223411304003 2.491586846163073
  0 2.5735807159095048 2.444154859972559
  0 2.483253378664943 2.5920542410645684
  0 2.449539832283609 2.4198137461666844
  0 2.592493973967338 2.5253487635830694
  0 2.413653085444253 2.5443118109293366
  0 2.534131931371266 2.4079349756548356
  0 2.537444319684339 2.591981039219283
  0 2.409254683294639 2.4569941009372
  0 2.597011645136703 2.4700902729584464
  0 2.4481213666877313 2.5885216904219224
  0 2.4782325716366533 2.39863288236502
  0 2.585390054914273 2.560657095236984
  0 2.395018130192394 2.5130836882500196
  0 2.569248066177611 2.4186445304674615
  0 2.5039310800440706 2.6077969614950227
  0 2.4235678540516954 2.422441012324276
  0 2.6097606697744946 2.505612136836731
  0 2.4145011933365104 2.570643371762769
  0 2.51546269608144 2.3891709958970107
  0 2.564021354912874 2.5929788171647767
  0 2.3890338399388695 2.4744669458700597
  0 2.5999134900867698 2.443393010711842
  0 2.4642678361543493 2.6101449064195434
  0 2.4515504572295823 2.3937787170371507
  0 2.6083469010076543 2.5459662854345173
  0 2.388174578191409 2.5396062696755757
  0 2.556139827519766 2.3944370683809493
  0 2.5301419503117923 2.616654647584366
  0 2.3982069210577848 2.4338437889781392
  0 2.6206439201274487 2.4798716389325794
  0 2.4240812517126984 2.597046799262736
  0 2.4903563208957933 2.37626492717236
  0 2.591342925442798 2.5853315297621657
  0 2.374122588225038 2.4987718263516987
  0 2.594300310419836 2.4152904145561434
  0 2.487601758074619 2.6270282536059635
  0 2.4228159615840053 2.3972666118708563
  0 2.627153396815233 2.523773298187604
  0 2.389457533809442 2.568812429128406
  0 2.5352566470346263 2.373772478121481
  0 2.5596494622556083 2.6176434923742358
  0 2.375765483849924 2.4532510337224407
  0 2.6239574669647263 2.450242001241747
  0 2.441850822386494 2.621167720145608
  0 2.460791422699121 2.370588787448204
  0 2.617030092499013 2.56935533954521
  0 2.366061901396326 2.5280788643264858
  0 2.580265554951594 2.3881657084190224
  0 2.5164530370542115 2.6374787142159573
  0 2.3943973275148 2.4092211144569537
  0 2.6399814828436297 2.4955788957232086
  0 2.3992037346697206 2.5983671988178445
  0 2.5079218295962478 2.358596786707928
  0 2.5901692694621516 2.610221405197951
  0 2.35829041823825 2.4795236487202277
  0 2.6189616807047766 2.418940538773125
  0 2.466860430305189 2.6408755403063746
  0 2.428902810981572 2.3730710046698476
  0 2.638885647671164 2.545805984526905
  0 2.365959388447278 2.5603502858962885
  0 2.5583683850342687 2.364265680878576
  0 2.548894506073418 2.640219942377593
  0 2.368574007453174 2.4292812284234633
  0 2.6453972962243504 2.463187045397916
  0 2.417250707904195 2.6259752088277826
  0 2.4758045518647522 2.350489431554928
  0 2.6194066051716414 2.5943531856075435
  0 2.3474941268423164 2.511137811768656
  0 2.6054257246519823 2.38824517913817
  0 2.497741117543979 2.654338109551656
  0 2.3969356843933736 2.384134851382564
  0 2.654971457346571 2.515889129276224
  0 2.3744264201235588 2.5933891014196266
  0 2.529643849569911 2.345620203344801
  0 2.582792389704998 2.6344579147734843
  0 2.347452951883195 2.4565887116659644
  0 2.6424306816688645 2.428653844048975
  0 2.44292205610934 2.649467429818452
  0 2.440869374850883 2.350589141524227
  0 2.645145628206724 2.5705295206218093
  0 2.3446753575747548 2.5462336817462137
  0 2.5836518972879596 2.3604031190959525
  0 2.532750208600874 2.660106165153898
  0 2.367153029923474 2.403667897194921
  0 2.663698146629863 2.4812186399591707
  0 2.3915407087579172 2.624932125748241
  0 2.495566225291826 2.333947518090755
  0 2.6158988392137728 2.6199257077567473
  0 2.3328692447544457 2.489818734421439
  0 2.630627637213445 2.394196412539854
  0 2.4750512757775853 2.6669046766533278
  0 2.4052875297348724 2.3595336726790754
  0 2.6653564366500344 2.5397507383431894
  0 2.3506511217078363 2.5827007623844653
  0 2.55446757982487 2.3375210244376388
  0 2.5698523839699985 2.657189091260032
  0 2.3417238355212726 2.4310213589505896
  0 2.6639082679804416 2.4437407069325774
  0 2.416836562805701 2.652762895653683
  0 2.4579791952791052 2.3305640452833276
  0 2.6459650809158863 2.5969026167811493
  0 2.326289376378103 2.527242841855817
  0 2.6100789720408226 2.3620804426065725
  0 2.5120371237155523 2.676680285418304
  0 2.371326099357884 2.377421559391329
  0 2.678303027706986 2.503479701812808
  0 2.3657089099181166 2.618286146037808
  0 2.519186975138644 2.3214525261714383
  0 2.6068244200659434 2.6451120770603898
  0 2.3226068421741086 2.4650390161260036
  0 2.6549425724519806 2.4056335160954063
  0 2.4493240439916746 2.6748308117319977
  0 2.4190008075556957 2.3363093549488205
  0 2.670862562113186 2.566205079319431
  0 2.328727904302232 2.566817872613118
  0 2.5814215387177573 2.3344979664664063
  0 2.5519256255720424 2.677611234682798
  0 2.341225642632938 2.4038004369815225
  0 2.6826415954947267 2.4635674419909344
  0 2.3895845274975946 2.6507160851591083
  0 2.479545051617078 2.313693421517267
  0 2.6413750065295876 2.623948718564266
  0 2.3114399814454054 2.5041143545458846
  0 2.6366829067561492 2.369190127601156
  0 2.4875366697028882 2.6893666716185582
  0 2.380909974889678 2.351493205384796
  0 2.688702615117738 2.5291488658623327
  0 2.3406847441824095 2.6062949378041247
  0 2.5458106894487926 2.313444441313299
  0 2.5925136661624473 2.6690102024244036
  0 2.317074938322363 2.4376840312097996
  0 2.6775014572782676 2.4221557836072996
  0 2.421468325386592 2.6778226550521325
  0 2.4376071659684815 2.315292431030656
  0 2.6712718659079875 2.5943256642018477
  0 2.3094434377856414 2.54627321883598
  0 2.6095677671145894 2.3366918562973846
  0 2.5296056716725426 2.694986616978095
  0 2.346021311961191 2.375869135863535
  0 2.6979466702106425 2.487483820087132
  0 2.3621080494677558 2.6433421786885463
  0 2.5048645516056154 2.300603065329188
  0 2.631468409339404 2.6507331747488934
  0 2.300690670047834 2.4775978834971815
  0 2.6625428438541943 2.381562172650576
  0 2.4600405383232498 2.697667821517917
  0 2.395659017416704 2.32678361278343
  0 2.6944686642790603 2.55739797266455
  0 2.3173427297814593 2.589277889168971
  0 2.5745785808815516 2.3102794519891856
  0 2.573357304752931 2.690777850152708
  0 2.3165553573103934 2.4086371161594604
  0 2.6975001668720413 2.443304067461881
  0 2.392385730710646 2.6756745426401993
  0 2.4605824479449794 2.297243338747679
  0 2.666456109203534 2.6231990341142883
  0 2.2935091849297007 2.5216520852379056
  0 2.637987488840164 2.3441527875359798
  0 2.5035346049498037 2.708657706502162
  0 2.356082626596841 2.3481449613832224
  0 2.7092244760988256 2.5147957063843904
  0 2.3353167682856597 2.6307473086684223
  0 2.5331966399203454 2.2918293012079087
  0 2.616428380954867 2.6763607667580596
  0 2.294511341776456 2.4484759231967836
  0 2.686784450211978 2.3989380412142185
  0 2.4303668709917536 2.7011835204603116
  0 2.415241309758973 2.304139904026923
  0 2.695273404962363 2.5873792955226596
  0 2.296496640644178 2.567637695911379
  0 2.6046196245955175 2.312210648511499
  0 2.5498256870479428 2.709640498231742
  0 2.3212248175339583 2.378786127326285
  0 2.7142090546346953 2.468543984478163
  0 2.362974349390499 2.668287261195602
  0 2.487332337194705 2.2828415492540093
  0 2.656394147110603 2.651923547768502
  0 2.2815495061700437 2.4936041757260514
  0 2.6657822247871916 2.3568238498458003
  0 2.474412557227676 2.7180597853947757
  0 2.371275212832606 2.321516534075491
  0 2.7159740305999405 2.544757879214794
  0 2.3100828177772885 2.6131421439943985
  0 2.563756682525734 2.28780575528528
  0 2.5965401477980943 2.6999823570356485
  0 2.2932651457546216 2.4175665449697323
  0 2.7085879258961603 2.4209602451667713
  0 2.399360947954243 2.6996236911861016
  0 2.439229940358474 2.284346416824872
  0 2.690901879702998 2.6182267804545236
  0 2.2788894914706552 2.5418673323051335
  0 2.6350535865972984 2.319376384574625
  0 2.522473991017164 2.7249020067397396
  0 2.331144161613317 2.349018776146815
  0 2.7269840552009565 2.4972624822049725
  0 2.3341226096236483 2.655677801522099
  0 2.5171906743302337 2.2726742459672282
  0 2.641180537484082 2.6796168276411647
  0 2.2740903254619513 2.4628435861262576
  0 2.692082370706577 2.3745337726268185
  0 2.442996025944164 2.7227321025246094
  0 2.391352524205931 2.296834058556946
  0 2.7178031738337975 2.5765772971086314
  0 2.287230523628557 2.5908464974274446
  0 2.595721230050345 2.2888530997302223
  0 2.5721942210521234 2.720805781238258
  0 2.297198915005824 2.3857172379034397
  0 2.727199304993214 2.4471706823486388
  0 2.367887746195095 2.6928171273335697
  0 2.467102840112272 2.268113173561807
  0 2.6812597178354904 2.6490646480562288
  0 2.2651819525223105 2.5125487208259787
  0 2.665000653061652 2.3317935747050518
  0 2.491939420318415 2.735956087614088
  0 2.346252821649226 2.320212112249463
  0 2.7352778750914126 2.528772072062463
  0 2.306698019861444 2.637983645112328
  0 2.549425068257784 2.267225569107432
  0 2.621028515115211 2.7054276095959993
  0 2.271548957368701 2.43014188249269
  0 2.716059484332112 2.39699531128726
  0 2.4100897231833036 2.7223273262446286
  0 2.4159556202184818 2.2748967541212384
  0 2.714437174277509 2.609422386062292
  0 2.267523707107324 2.5642881383479135
  0 2.6282383375925655 2.295171409548055
  0 2.543883800421788 2.738108517195941
  0 2.3005125593997264 2.3493190090198754
  0 2.7488793772029214 2.476355643314187
  0 2.3324556263103746 2.685550216504727
  0 2.498204636508787 2.250006446743252
  0 2.6701920640161427 2.683124715278755
  0 2.250806700888379 2.4799326215497324
  0 2.697302702765 2.346469405388939
  0 2.458223553952324 2.7464847430483794
  0 2.364306599539549 2.290030237721048
  0 2.7418886269679863 2.5631655930356265
  0 2.278971109485872 2.616817077339289
  0 2.584071023074612 2.2645598524482535
  0 2.5970461785872825 2.730395397570362
  0 2.272811313272003 2.395667355910013
  0 2.7379975555021385 2.423467891868795
  0 2.3762047057560074 2.717197433509338
  0 2.4445680389539706 2.256222852394669
  0 2.7055429000963516 2.642309930152401
  0 2.2523100857640066 2.533907320533571
  0 2.6597347682466683 2.3076856640466366
  0 2.5121230205317002 2.749705891747047
  0 2.322386955656571 2.32406362945923
  0 2.7498096419474782 2.509754116570592
  0 2.3092093335115105 2.661551606556165
  0 2.531556557445387 2.2519996296732683
  0 2.6442530197694514 2.7041839031054953
  0 2.2557080678609926 2.446882659217628
  0 2.716013516080399 2.3741502448529075
  0 2.4257286441350927 2.738712726300858
  0 2.3935172566145257 2.273811084796131
  0 2.731305477914605 2.5948566069744015
  0 2.2653678218989497 2.586300295477808
  0 2.6147154539402835 2.2778730889170005
  0 2.565456966960666 2.7412786469547403
  0 2.2887526854793245 2.3663041806644545'
  #end_points = '5 5 0'
  directions = '1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0
  1 0 0'
  execute_on = TIMESTEP_BEGIN

  # Needed to cache trace information for RayTracingMeshOutput
  always_cache_traces = true
  # Needed to cache Ray data for RayTracingMeshOutput
  data_on_cache_traces = true
[]

# [UserObjects/study]
#   type = ConeRayStudy

#   start_points = '2.5 2.5 2.5'
#   directions = '1 0 0'
#   half_cone_angles = 20
#   ray_data_name = weight

#   azimuthal_quad_orders = 100

#   # Must be set with RayKernels that
#   # contribute to the residual
#   execute_on = TIMESTEP_BEGIN

#   # For outputting Rays
#   always_cache_traces = true
#   data_on_cache_traces = true
# []

[MultiApps]
  [reinit]
    type = LevelSetReinitializationMultiApp
    input_files = 'sub_3d.i'
    execute_on = 'timestep_end'
  []
[]

[Transfers]
  [to_sub]
    type = MultiAppCopyTransfer
    source_variable = phi
    variable = phi
    to_multi_app = reinit
    execute_on = 'timestep_end'
  []
  [to_sub_init]
    type = MultiAppCopyTransfer
    source_variable = phi
    variable = phi_0
    to_multi_app = reinit
    execute_on = 'timestep_end'
  []
  [from_sub]
    type = MultiAppCopyTransfer
    source_variable = phi
    variable = phi
    from_multi_app = reinit
    execute_on = 'timestep_end'
  []
[]

[Executioner]
  type = Transient
  solve_type = PJFNK
  start_time = 0
  end_time = 1.570796
  scheme = crank-nicolson
  petsc_options_iname = '-pc_type'
  petsc_options_value = 'lu'
  dt = 0.01
  num_steps = 150
[]

[Outputs]
  exodus = true
  csv = true
  [rays]
    type = RayTracingExodus
    study = study
    execute_on = TIMESTEP_END
  []
[]
